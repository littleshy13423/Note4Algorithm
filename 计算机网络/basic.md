# 基础知识

## OSI模型与TCP/IP模型

### OSI模型

物理层（Physical Layer）：负责比特流，物理设备，电压、电流等。

数据链路层（Data Link Layer）：使用mac地址，通过查表确定传输端口，one hop 数据传输，错误检测与纠正。常见协议有以太网（Ethernet）。

网络层（Network Layer）： 使用IP地址，IP地址具有hierarchicl的结构，负责路径选择和数据包的转发。

传输层（Transport Layer）： 提供端到端的通信服务，负责数据的分段、传输和重组，常见协议有TCP、UDP。

会话层（Session Layer）： 负责建立、管理和终止会话。会话层处理连接的建立、数据传输的同步和恢复。

表示层（Presentation Layer）： 理数据的格式转换、加密/解密、压缩/解压缩。处

应用层（Application Layer）： 为应用程序提供网络服务接口，常见协议有HTTP、FTP、SMTP。

### TCP/IP模型

TCP/IP模型是由四层组成的模型：

网络接口层（Link Layer）

互联网层（Internet Layer）

传输层（Transport Layer）

应用层（Application Layer）

## TCP与UDP

TCP（Transmission Control Protocol）： 面向连接的协议，提供可靠的字节流传输，通过三次握手建立连接，具有流量控制、拥塞控制和错误校验机制。适用于需要可靠传输的应用，如HTTP、FTP。

UDP（User Datagram Protocol）： 无连接的协议，提供不可靠的传输，不保证数据包的到达顺序和完整性。适用于对速度要求高但可以容忍丢包的应用，如视频流、在线游戏。

### TCP协议

#### 一、流量控制（Flow Control）

流量控制是TCP用于防止发送方发送数据过快，超过接收方处理能力的机制。它通过接收方向发送方反馈当前可接收的数据量，确保发送方不会超出接收方的处理能力。

滑动窗口（Sliding Window）：

TCP使用滑动窗口来实现流量控制。每个TCP连接都有一个接收窗口，大小由接收方决定。
接收方通过TCP报文中的Window Size字段告诉发送方自己可以接收的字节数。这是接收方当前缓冲区的剩余空间。
发送方根据这个窗口大小决定自己可以发送的最大数据量。如果接收方的窗口变小或为零，发送方必须停止发送，直到接收到更新的窗口大小。

零窗口探测（Zero Window Probe）：

当接收方的窗口大小变为零时，发送方会停止发送数据，但发送方会周期性地发送探测报文，询问接收方是否可以继续接收数据。一旦接收方的窗口大小恢复到非零，发送方就会继续传输数据。

#### 二、TCP拥塞控制（Congestion Control）

拥塞控制是TCP用于避免网络中因数据流量过大导致拥塞的机制。TCP的拥塞控制通过动态调整发送速率来避免网络拥塞。TCP的拥塞控制主要通过以下几个方法来实现：

慢启动（Slow Start）：

慢启动是拥塞控制的初始阶段，发送方开始时将拥塞窗口（Congestion Window, cwnd）设置为一个较小的值（通常是1个MSS，最大报文段大小）。
每次成功收到确认（ACK）后，发送方将拥塞窗口加倍（指数增长），直到达到慢启动阈值（ssthresh）或发生丢包。

拥塞避免（Congestion Avoidance）：

当拥塞窗口达到慢启动阈值后，TCP进入拥塞避免阶段。在这个阶段，拥塞窗口不再指数增长，而是线性增长，每个RTT（往返时间）内增加一个MSS的大小。
这样做是为了在接近网络带宽极限时，减缓增长速度，避免拥塞。
快速重传和快速恢复（Fast Retransmit & Fast Recovery）：

如果TCP检测到网络中存在丢包（通过重复ACK确认），它会触发快速重传，立即重传丢失的报文段，而无需等待超时。
随后，TCP进入快速恢复阶段，将拥塞窗口减半（乘以0.5），并将慢启动阈值设置为当前窗口的一半，从而减缓传输速率，避免进一步拥塞。
拥塞窗口与实际窗口的关系：

实际传输窗口大小取决于接收窗口（由接收方确定）和拥塞窗口（由发送方根据网络状况动态调整）之间的较小值。
